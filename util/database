-- This script was generated by a beta version of the ERD tool in pgAdmin 4.
-- Please log an issue at https://redmine.postgresql.org/projects/pgadmin4/issues/new if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS public.clientes
(
    id_cliente integer NOT NULL DEFAULT nextval('clientes_id_cliente_seq'::regclass),
    nome text COLLATE pg_catalog."default" NOT NULL,
    cpf text COLLATE pg_catalog."default" NOT NULL,
    endereco text COLLATE pg_catalog."default" NOT NULL,
    cidade text COLLATE pg_catalog."default" NOT NULL,
    estado text COLLATE pg_catalog."default" NOT NULL,
    telefone text COLLATE pg_catalog."default" NOT NULL,
    email text COLLATE pg_catalog."default" NOT NULL,
    "dataNascimento" date NOT NULL,
    ativo boolean NOT NULL DEFAULT true,
    "createdAt" timestamp without time zone NOT NULL DEFAULT now(),
    "updatedAt" timestamp without time zone NOT NULL DEFAULT now(),
    CONSTRAINT "PK_4b7c4b981b60b5c6b1d04c84a54" PRIMARY KEY (id_cliente)
);

CREATE TABLE IF NOT EXISTS public.funcionarios
(
    id_funcionario integer NOT NULL DEFAULT nextval('funcionarios_id_funcionario_seq'::regclass),
    nome text COLLATE pg_catalog."default" NOT NULL,
    cpf text COLLATE pg_catalog."default" NOT NULL,
    endereco text COLLATE pg_catalog."default" NOT NULL,
    ativo boolean NOT NULL DEFAULT true,
    "dataNascimento" text COLLATE pg_catalog."default" NOT NULL,
    "dataAdmissao" text COLLATE pg_catalog."default" NOT NULL,
    "dataDemissao" text COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT "PK_afef3d6c66975bd4faeb3c568c0" PRIMARY KEY (id_funcionario)
);

CREATE TABLE IF NOT EXISTS public.migrations
(
    id integer NOT NULL DEFAULT nextval('migrations_id_seq'::regclass),
    "timestamp" bigint NOT NULL,
    name character varying COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT "PK_8c82d7f526340ab734260ea46be" PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.ordemdeservicos
(
    id_os integer NOT NULL DEFAULT nextval('ordemdeservicos_id_os_seq'::regclass),
    "createdAt" timestamp without time zone NOT NULL DEFAULT now(),
    "updatedAt" timestamp without time zone NOT NULL DEFAULT now(),
    id_cliente integer,
    id_funcionario integer,
    CONSTRAINT "PK_a4e202e1e4f604fb8e19398b906" PRIMARY KEY (id_os),
    CONSTRAINT "REL_157ac95e297825ff0a5779c916" UNIQUE (id_funcionario),
    CONSTRAINT "REL_562fa164c9eb82a342aa2974e0" UNIQUE (id_cliente)
);

CREATE TABLE IF NOT EXISTS public.servicos
(
    id_servico integer NOT NULL DEFAULT nextval('servicos_id_servico_seq'::regclass),
    descricao text COLLATE pg_catalog."default" NOT NULL,
    valor double precision NOT NULL,
    "createdAt" timestamp without time zone NOT NULL DEFAULT now(),
    "updatedAt" timestamp without time zone NOT NULL DEFAULT now(),
    "osIdOs" integer,
    CONSTRAINT "PK_da00aac049cfefb5812fb0fec57" PRIMARY KEY (id_servico)
);

CREATE TABLE IF NOT EXISTS public.usuarios
(
    id_usuario integer NOT NULL DEFAULT nextval('usuarios_id_usuario_seq'::regclass),
    nome text COLLATE pg_catalog."default" NOT NULL,
    rg text COLLATE pg_catalog."default" NOT NULL,
    cpf text COLLATE pg_catalog."default" NOT NULL,
    endereco text COLLATE pg_catalog."default" NOT NULL,
    email text COLLATE pg_catalog."default" NOT NULL,
    telefone text COLLATE pg_catalog."default" NOT NULL,
    senha text COLLATE pg_catalog."default" NOT NULL,
    ativo boolean NOT NULL DEFAULT true,
    "createdAt" timestamp without time zone NOT NULL DEFAULT now(),
    "updatedAt" timestamp without time zone NOT NULL DEFAULT now(),
    CONSTRAINT "PK_dfe59db369749f9042499fd8107" PRIMARY KEY (id_usuario)
);

ALTER TABLE IF EXISTS public.ordemdeservicos
    ADD CONSTRAINT fk_id_cliente FOREIGN KEY (id_cliente)
    REFERENCES public.clientes (id_cliente) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS "REL_562fa164c9eb82a342aa2974e0"
    ON public.ordemdeservicos(id_cliente);


ALTER TABLE IF EXISTS public.ordemdeservicos
    ADD CONSTRAINT fk_id_funcionario FOREIGN KEY (id_funcionario)
    REFERENCES public.funcionarios (id_funcionario) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS "REL_157ac95e297825ff0a5779c916"
    ON public.ordemdeservicos(id_funcionario);


ALTER TABLE IF EXISTS public.servicos
    ADD CONSTRAINT "FK_dbaa2f6d79baa207a1321796a80" FOREIGN KEY ("osIdOs")
    REFERENCES public.ordemdeservicos (id_os) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;

END;